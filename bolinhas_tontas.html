<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <style type="text/css">
	html, body {
		width:  100%;
		height: 100%;
		margin: 0px;
	}
	
	#maincanvas { margin: 0px; border: 1px solid black}
	
	@media screen {
	  div.normal_text {
		color: red;
		display: block;
	  }
	  
	  div.mobile_text {
		display: none;
	  }
	}

	@media (max-width: 700px) {
	  div.normal_text {
		display: none;
	  }
	  
	  div.mobile_text {
		color: green;
		display: block;
	  }
	}
  </style>
  <script type="application/javascript">
	var canvas;
	var ctx;
	var jumps = 0;
	var raf;
	var balls = [];
	var numBalls = 10;
	var running = false;
	var time;
	
	function init() {
		time = new Date().getTime();
		
		for(var i=0; i < numBalls; i++){
			balls[balls.length] = new ball();
		}
	
		canvas = document.getElementById('maincanvas');
		
		canvas.width = document.body.clientWidth-2; //document.width is obsolete
		canvas.height = document.body.clientHeight-25; //document.height is obsolete
		
		canvas.addEventListener("touchstart",function(e){
			for(var i=0; i < balls.length; i++){				
				if(Math.sqrt(Math.pow(( balls[i].x -e.changedTouches[0].pageX ), 2) + Math.pow(( balls[i].y - e.changedTouches[0].pageY ), 2)) <= balls[i].radius*canvas.width){
					balls[i].color = 'red';
				}
			}
		}, false);
		ctx = canvas.getContext('2d');
		
		repaint();
		
		draw();
	}
	
	var fps = {
		current: 0,
		last: 0,
		qtd: 50,
		counter: 0,
		lastUpdated: Date.now(),
		draw: function() {
			ctx.font = '12pt Arial';
			ctx.fillStyle = '#000';
			ctx.textBaseline = 'top';
			ctx.fillText(fps.last + 'fps', 5, 5);
		},
		update: function() {
			fps.current ++;
			if (Date.now() - fps.lastUpdated >= 1000) {
				fps.last = fps.current;
				fps.current = 0;
				fps.lastUpdated = Date.now();
			}
		}
	}	
	
	function ball() {
	  this.x = 500*Math.random(),
	  this.y = 500*Math.random(),
	  this.vx = 2*Math.random(),
	  this.vy = 2*Math.random(),
	  this.flagx = 1,
	  this.flagy = 1,
	  this.radius = 0.05,
	  this.color = 'blue',
	  this.draw = function() {
	  	if (this.y + this.vy > canvas.height || this.y + this.vy < 0) {
		  this.flagy = -this.flagy;
		  this.vy = this.flagy*10*Math.random();
		  
		}
		if (this.x + this.vx > canvas.width || this.x + this.vx < 0) {
		  this.flagx = -this.flagx;
		  this.vx = this.flagx*10*Math.random();
		}
		
		this.y += this.vy;
		this.x += this.vx;
		
		ctx.beginPath();
		ctx.arc(this.x, this.y, this.radius*canvas.width, 0, Math.PI*2, true);
		ctx.closePath();
		ctx.fillStyle = this.color;
		ctx.fill();
	  }
	};
	
	function repaint(){
		ctx.canvas.width  = window.innerWidth-2;
		ctx.canvas.height = window.innerHeight-2;
		
		
		canvas.width = document.body.clientWidth-2;
		canvas.height = document.body.clientHeight-25;
		
		ctx.clearRect(0,0, canvas.width, canvas.height);
		
		for(var i=0; i < balls.length; i++){
			balls[i].draw();
		}
		
		fps.update();
		fps.draw();
	}
	
	function draw() {
	
		var now = new Date().getTime();
		
		repaint();
				
		window.requestAnimationFrame(draw);
	}
	
  </script>
 </head>
 <body onload="init();">
	<div class="normal_text">Estou em um desktop.</div>
	<div class="mobile_text">Estou em um mobile.</div>
	<canvas id="maincanvas" ></canvas>
 </body>
</html>
